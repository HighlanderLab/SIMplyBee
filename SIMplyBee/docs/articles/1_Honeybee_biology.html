<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SIMplyBee - Honeybee biology • SIMplyBee</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="SIMplyBee - Honeybee biology">
<meta property="og:description" content="SIMplyBee">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SIMplyBee</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-question-circle"></span>
     
    Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/1_Honeybee_biology.html">Honeybee Biology</a>
    </li>
    <li>
      <a href="../articles/2_Colony_events.html">Colony Events</a>
    </li>
    <li>
      <a href="../articles/3_Multiple_colonies.html">Multiple colonies</a>
    </li>
    <li>
      <a href="../articles/4_Genomics.html">Genomics</a>
    </li>
    <li>
      <a href="../articles/5_Sampling_functions.html">Sampling functions</a>
    </li>
    <li>
      <a href="../articles/6_Quantitative_Genetics.html">Quantitative Genetics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/HighlanderLab/SIMplyBee/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>SIMplyBee - Honeybee biology</h1>
            
            <h4 data-toc-skip class="date">2022-08-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/HighlanderLab/SIMplyBee/blob/HEAD/vignettes/1_Honeybee_biology.Rmd" class="external-link"><code>vignettes/1_Honeybee_biology.Rmd</code></a></small>
      <div class="hidden name"><code>1_Honeybee_biology.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette introduces SIMplyBee package by describing and
demonstrating how SIMplyBee implements honeybee biology. Specifically,
it describes:</p>
<ol style="list-style-type: decimal">
<li><p>Initiating simulation with founder genomes and simulation
parameters,</p></li>
<li><p>Creating and building up a colony,</p></li>
<li><p>Colony structure,</p></li>
<li><p>Sex and caste,</p></li>
<li><p>Complementary sex determining (csd) locus, and</p></li>
<li><p>Inheritance system.</p></li>
</ol>
<p>Now load the package and dive in!</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"SIMplyBee"</span><span class="op">)</span></span>
<span><span class="co"># Loading required package: AlphaSimR</span></span>
<span><span class="co"># Loading required package: R6</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Attaching package: 'SIMplyBee'</span></span>
<span><span class="co"># The following object is masked from 'package:base':</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#     split</span></span></code></pre></div>
<p>TODO: Say something about the image (covering 1-4) and how you can
use it as a guide?</p>
<p>TODO: add colony creation image - not working yet #
knitr::include_graphics(“~/Desktop/GitHub/SIMplyBee/SIMplyBee/vignettes/images/founderpop_diagram2.pdf”,
auto_pdf = getOption(“knitr.graphics.auto_pdf”,FALSE))</p>
</div>
<div class="section level2">
<h2 id="initiating-simulation-with-founder-genomes-and-global-parameters">Initiating simulation with founder genomes and global
parameters,<a class="anchor" aria-label="anchor" href="#initiating-simulation-with-founder-genomes-and-global-parameters"></a>
</h2>
<p>We initiate the simulation by simulating founder honeybee genomes. We
can quickly generate genomes using AlphaSimR’s <code><a href="https://rdrr.io/pkg/AlphaSimR/man/quickHaplo.html" class="external-link">quickHaplo()</a></code>
or with SIMplyBee’s <code>TODO()</code> with appropriate honeybee genome
parameters and demography. We will use <code><a href="https://rdrr.io/pkg/AlphaSimR/man/quickHaplo.html" class="external-link">quickHaplo()</a></code> and
simulate genomes of two founding individuals. In this example, the
genomes will be represented by only three chromosomes and 1000
segregating sites per chromosome. Honeybees have 16 chromosomes and far
more segregating sites per chromosome, but we want a quick simulation
here.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">founderGenomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AlphaSimR/man/quickHaplo.html" class="external-link">quickHaplo</a></span><span class="op">(</span>nInd <span class="op">=</span> <span class="fl">2</span>, nChr <span class="op">=</span> <span class="fl">3</span>, segSites <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p>Now we are ready to setup global simulation parameters using
<code>SimParamBee</code>. <code>SimParamBee</code> enables the user to
tweak many simulation settings, which you can read about in the help
pages (<code><a href="../reference/SimParamBee.html">help(SimParamBee)</a></code> and <code><a href="https://rdrr.io/pkg/AlphaSimR/man/SimParam.html" class="external-link">help(SimParam)</a></code>).
Here we will point out that we recommend saving this object with the
name <code>SP</code>. Namely, all SIMplyBee functions will use this
object, if you don’t directly specify <code>simParamBee</code>
argument.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SP</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/SimParamBee.html">SimParamBee</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">founderGenomes</span><span class="op">)</span></span></code></pre></div>
<p>There are many options provided by <code>SimParamBee</code> of which
we will not talk about now. You can quickly take a peek into the
information and functions stored in the <code>SP</code> object. The
following code gives a lot of output and we suggest you return back to
this point once you are comfortable with the basic functionality!</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">show</span><span class="op">(</span><span class="va">SP</span><span class="op">)</span></span></code></pre></div>
<p>From the simulated genomes, we will create virgin queens. These will
serve as our our first honeybee individuals. In SIMplyBee, we use
AlphaSimR’s populations (<code>Pop</code> class). So, the
<code>basePop</code> is a population of two individuals, our virgin
queens.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baseQueens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createVirginQueens.html">createVirginQueens</a></span><span class="op">(</span><span class="va">founderGenomes</span><span class="op">)</span></span>
<span><span class="va">baseQueens</span></span>
<span><span class="co"># An object of class "Pop" </span></span>
<span><span class="co"># Ploidy: 2 </span></span>
<span><span class="co"># Individuals: 2 </span></span>
<span><span class="co"># Chromosomes: 3 </span></span>
<span><span class="co"># Loci: 300 </span></span>
<span><span class="co"># Traits: 0</span></span>
<span><span class="fu"><a href="../reference/isVirginQueen.html">isVirginQueen</a></span><span class="op">(</span><span class="va">baseQueens</span><span class="op">)</span></span>
<span><span class="co"># [1] TRUE TRUE</span></span></code></pre></div>
<p>We will use the first virgin queen to create five drones for mating.
Technically, virgin queens do not create drones. Only queens with
colonies create drones. However, to get the simulation up and running,
we need drones and the function <code><a href="../reference/createDrones.html">createDrones()</a></code> can work
both with virgin queens or colonies (we will talk about colonies in the
next section).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baseDrones</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createDrones.html">createDrones</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">baseQueens</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, nInd <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="va">baseDrones</span></span>
<span><span class="co"># An object of class "Pop" </span></span>
<span><span class="co"># Ploidy: 2 </span></span>
<span><span class="co"># Individuals: 15 </span></span>
<span><span class="co"># Chromosomes: 3 </span></span>
<span><span class="co"># Loci: 300 </span></span>
<span><span class="co"># Traits: 0</span></span></code></pre></div>
<p>A keen reader will notice that drones’ ploidy is two. We will address
this in the next sections.</p>
</div>
<div class="section level2">
<h2 id="creating-and-building-up-a-colony">Creating and building up a colony<a class="anchor" aria-label="anchor" href="#creating-and-building-up-a-colony"></a>
</h2>
<p>We will use the other virgin queen to create a colony. In SIMplyBee,
a colony is an object of <code>Colony</code> class with all sorts of
information.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colony</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createColony.html">createColony</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">baseQueens</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">colony</span></span>
<span><span class="co"># An object of class "Colony" </span></span>
<span><span class="co"># Id: 1 </span></span>
<span><span class="co"># Location: </span></span>
<span><span class="co"># Queen: NA </span></span>
<span><span class="co"># Number of fathers: 0 </span></span>
<span><span class="co"># Number of workers: 0 </span></span>
<span><span class="co"># Number of drones: 0 </span></span>
<span><span class="co"># Number of virgin queens: 1 </span></span>
<span><span class="co"># Has split: FALSE </span></span>
<span><span class="co"># Has swarmed: FALSE </span></span>
<span><span class="co"># Has superseded: FALSE </span></span>
<span><span class="co"># Has collapsed: FALSE </span></span>
<span><span class="co"># Is productive: FALSE</span></span></code></pre></div>
<p>Before we look into the colony, lets mate the virgin queen, so that
she becomes a queen and can start laying eggs for her own workers and
drones.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colony</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross.html">cross</a></span><span class="op">(</span><span class="va">colony</span>, fathers <span class="op">=</span> <span class="va">baseDrones</span><span class="op">)</span></span>
<span><span class="va">colony</span></span>
<span><span class="co"># An object of class "Colony" </span></span>
<span><span class="co"># Id: 1 </span></span>
<span><span class="co"># Location: </span></span>
<span><span class="co"># Queen: 2 </span></span>
<span><span class="co"># Number of fathers: 15 </span></span>
<span><span class="co"># Number of workers: 0 </span></span>
<span><span class="co"># Number of drones: 0 </span></span>
<span><span class="co"># Number of virgin queens: 0 </span></span>
<span><span class="co"># Has split: FALSE </span></span>
<span><span class="co"># Has swarmed: FALSE </span></span>
<span><span class="co"># Has superseded: FALSE </span></span>
<span><span class="co"># Has collapsed: FALSE </span></span>
<span><span class="co"># Is productive: FALSE</span></span></code></pre></div>
<p>We build up colony with workers and drones using
<code>buildUpColony()</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/buildUp.html">buildUp</a></span><span class="op">(</span><span class="va">colony</span>, nWorkers <span class="op">=</span> <span class="fl">10</span>, nDrones <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="co"># An object of class "Colony" </span></span>
<span><span class="co"># Id: 1 </span></span>
<span><span class="co"># Location: </span></span>
<span><span class="co"># Queen: 2 </span></span>
<span><span class="co"># Number of fathers: 15 </span></span>
<span><span class="co"># Number of workers: 10 </span></span>
<span><span class="co"># Number of drones: 7 </span></span>
<span><span class="co"># Number of virgin queens: 0 </span></span>
<span><span class="co"># Has split: FALSE </span></span>
<span><span class="co"># Has swarmed: FALSE </span></span>
<span><span class="co"># Has superseded: FALSE </span></span>
<span><span class="co"># Has collapsed: FALSE </span></span>
<span><span class="co"># Is productive: TRUE</span></span></code></pre></div>
<p>Of note, we have not saved the result of the
<code>buildUpColony()</code> call, so our currently saved colony object
<code>colony</code> still doesn’t contain workers and drones.</p>
<p>At this point, its worth mentioning that <code>SimParamBee</code>
(saved as the <code>SP</code> object) conveniently holds some defaults
for the number of workers and drones. The defaults are just some numbers
to work with. You should adapt these defaults to your needs.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SP</span><span class="op">$</span><span class="va">nWorkers</span></span>
<span><span class="co"># [1] 100</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SP</span><span class="op">$</span><span class="va">nDrones</span></span>
<span><span class="co"># [1] 100</span></span></code></pre></div>
<p>When we run SIMplyBee functions, such defaults are automatically
used. We show this now by calling the <code><a href="../reference/buildUp.html">buildUp()</a></code> function on
our colony. Note that now we are saving the function output and
rewriting the currently saved colony object.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colony</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildUp.html">buildUp</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span></span>
<span><span class="va">colony</span></span>
<span><span class="co"># An object of class "Colony" </span></span>
<span><span class="co"># Id: 1 </span></span>
<span><span class="co"># Location: </span></span>
<span><span class="co"># Queen: 2 </span></span>
<span><span class="co"># Number of fathers: 15 </span></span>
<span><span class="co"># Number of workers: 100 </span></span>
<span><span class="co"># Number of drones: 100 </span></span>
<span><span class="co"># Number of virgin queens: 0 </span></span>
<span><span class="co"># Has split: FALSE </span></span>
<span><span class="co"># Has swarmed: FALSE </span></span>
<span><span class="co"># Has superseded: FALSE </span></span>
<span><span class="co"># Has collapsed: FALSE </span></span>
<span><span class="co"># Is productive: TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="colony-structure">Colony structure<a class="anchor" aria-label="anchor" href="#colony-structure"></a>
</h2>
<p>Lets explore this colony. In every colony we have different groups of
individuals (castes). These include: queen, fathers, workers, drones,
and virgin queens. The queen controls the colony, workers do all the
hard work, drones disseminate queen’s genes, and one of the virgin
queens will eventually replace the queen. We also store fathers, which
represent drones that the queen mated with. Storing fathers enables us
to generate colony members on demand. Let’s count how many individuals
we have for each caste.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nQueens.html">nQueens</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span></span>
<span><span class="co"># [1] 1</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nFathers.html">nFathers</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span></span>
<span><span class="co"># [1] 15</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nWorkers.html">nWorkers</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span></span>
<span><span class="co"># [1] 100</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nDrones.html">nDrones</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span></span>
<span><span class="co"># [1] 100</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nVirginQueens.html">nVirginQueens</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span></span>
<span><span class="co"># [1] 0</span></span></code></pre></div>
<p>We can also access castes using <code>get*()</code> functions.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">queen</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCastePop.html">getQueen</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># An object of class "Pop" </span></span>
<span><span class="co"># Ploidy: 2 </span></span>
<span><span class="co"># Individuals: 1 </span></span>
<span><span class="co"># Chromosomes: 3 </span></span>
<span><span class="co"># Loci: 300 </span></span>
<span><span class="co"># Traits: 0</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fathers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCastePop.html">getFathers</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># An object of class "Pop" </span></span>
<span><span class="co"># Ploidy: 2 </span></span>
<span><span class="co"># Individuals: 15 </span></span>
<span><span class="co"># Chromosomes: 3 </span></span>
<span><span class="co"># Loci: 300 </span></span>
<span><span class="co"># Traits: 0</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">workers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCastePop.html">getWorkers</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># An object of class "Pop" </span></span>
<span><span class="co"># Ploidy: 2 </span></span>
<span><span class="co"># Individuals: 100 </span></span>
<span><span class="co"># Chromosomes: 3 </span></span>
<span><span class="co"># Loci: 300 </span></span>
<span><span class="co"># Traits: 0</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">drones</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCastePop.html">getDrones</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># An object of class "Pop" </span></span>
<span><span class="co"># Ploidy: 2 </span></span>
<span><span class="co"># Individuals: 100 </span></span>
<span><span class="co"># Chromosomes: 3 </span></span>
<span><span class="co"># Loci: 300 </span></span>
<span><span class="co"># Traits: 0</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">virginQueens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCastePop.html">getVirginQueens</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># NULL</span></span></code></pre></div>
<p>As you see above, there are no virgin queens present in the colony at
this moment, since the queen is active. Future colony events will change
this.</p>
<p>Should you want to pull out, that is, remove castes, or their
members, have a look at <code>pull*()</code> functions.</p>
<p>There is additional information that you can retrieve. Peek under the
hood and view the complete colony data structure with
<code>str(colony)</code>. This gives a lot of output and we suggest you
return back to this point once you are comfortable with the basic
functionality!</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">colony</span><span class="op">)</span></span></code></pre></div>
<p>To explore the various accessor or modification functions, study the
SIMplyBee’s index of functions.</p>
<p>TODO: point to PkdDown too</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">SIMplyBee</span><span class="op">)</span></span></code></pre></div>
<p>The caste information of colony members is as you would expect:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getCaste.html">getCaste</a></span><span class="op">(</span><span class="va">queen</span><span class="op">)</span></span>
<span><span class="co"># [1] "queen"</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getCaste.html">getCaste</a></span><span class="op">(</span><span class="va">fathers</span><span class="op">)</span></span>
<span><span class="co">#  [1] "fathers" "fathers" "fathers" "fathers" "fathers" "fathers" "fathers"</span></span>
<span><span class="co">#  [8] "fathers" "fathers" "fathers" "fathers" "fathers" "fathers" "fathers"</span></span>
<span><span class="co"># [15] "fathers"</span></span></code></pre></div>
<p>and so on. When you have a bunch of bees at hand and you might not
know their source, the <code><a href="../reference/getCaste.html">getCaste()</a></code> can be very useful.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">queen</span>, <span class="va">fathers</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">workers</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="va">drones</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/getCaste.html">getCaste</a></span><span class="op">(</span><span class="va">bees</span><span class="op">)</span></span>
<span><span class="co"># [1] "queen"   "fathers" "fathers" "workers" "workers" "drones"  "drones"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="complementary-sex-determining-locus">Complementary sex determining locus<a class="anchor" aria-label="anchor" href="#complementary-sex-determining-locus"></a>
</h2>
<p>TODO: add genome image (tree and inheritance and csd)?</p>
<p>The complementary sex determining (csd) locus, well, complements sex
determination. Fertilised eggs that are heterozygous at the csd locus
develop into workers. On the other hand, homozygous eggs develop into
unviable drones. These drones are usually discarded by workers.
SIMplyBee doesn’t store these unviable drones, but it does store their
number.</p>
<p>We can retrieve information about csd variation with
<code><a href="../reference/getCsdAlleles.html">getCsdAlleles()</a></code>. For details on where the csd locus is and
the number of distinct alleles, see <code><a href="../reference/SimParamBee.html">help(SimParamBee)</a></code>. The
output below shows two sequences (in two rows) of 0s and 1s representing
respectively ancestral and mutation alleles along the csd locus for the
queen. You can see that the two sequences are different, meaning that
she is heterozygous, as expected.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getCsdAlleles.html">getCsdAlleles</a></span><span class="op">(</span><span class="va">queen</span><span class="op">)</span></span>
<span><span class="co">#     3_86 3_87 3_88 3_89 3_90 3_91 3_92</span></span>
<span><span class="co"># 2_1    1    0    1    0    0    1    0</span></span>
<span><span class="co"># 2_2    1    1    0    0    0    0    1</span></span></code></pre></div>
<p>Technically, SIMplyBee represents the csd locus as a series of
bi-allelic single nucleotide polymorphisms that don’t recombine. So, the
csd locus is represented as a haplotype and different haplotypes
represent different csd alleles. By varying the number of sites within
the csd locus we can control the number of distinct alleles (see
<code><a href="../reference/SimParamBee.html">help(SimParamBee)</a></code>).</p>
<p>A keen geneticist would immediately inspect csd alleles of fathers to
check for any similarity with the queen’s csd alleles. Lets boost a
chance of such an event by creating an inbreed colony. We will create a
virgin queen from the current colony and mate her with her brothers. Oh,
dear me.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inbredColony</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createColony.html">createColony</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="../reference/createVirginQueens.html">createVirginQueens</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">colony</span>, nInd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fathers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AlphaSimR/man/selectInd.html" class="external-link">selectInd</a></span><span class="op">(</span><span class="va">drones</span>, nInd <span class="op">=</span> <span class="va">SP</span><span class="op">$</span><span class="va">nFathers</span>, use <span class="op">=</span> <span class="st">"rand"</span><span class="op">)</span></span>
<span><span class="va">inbredColony</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross.html">cross</a></span><span class="op">(</span><span class="va">inbredColony</span>, fathers <span class="op">=</span> <span class="va">fathers</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/getCsdAlleles.html">getCsdAlleles</a></span><span class="op">(</span><span class="va">inbredColony</span><span class="op">)</span></span>
<span><span class="co"># $queen</span></span>
<span><span class="co">#       3_86 3_87 3_88 3_89 3_90 3_91 3_92</span></span>
<span><span class="co"># 235_1    1    0    1    0    0    1    0</span></span>
<span><span class="co"># 235_2    0    1    0    1    0    1    1</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $fathers</span></span>
<span><span class="co">#       3_86 3_87 3_88 3_89 3_90 3_91 3_92</span></span>
<span><span class="co"># 167_1    1    1    0    0    0    0    1</span></span>
<span><span class="co"># 150_1    1    0    1    0    0    1    0</span></span>
<span><span class="co"># 142_1    1    0    1    0    0    1    0</span></span>
<span><span class="co"># 153_1    1    0    1    0    0    1    0</span></span>
<span><span class="co"># 220_1    1    1    0    0    0    0    1</span></span>
<span><span class="co"># 191_1    1    1    0    0    0    0    1</span></span>
<span><span class="co"># 199_1    1    0    1    0    0    1    0</span></span>
<span><span class="co"># 156_1    1    1    0    0    0    0    1</span></span>
<span><span class="co"># 146_1    1    0    1    0    0    1    0</span></span>
<span><span class="co"># 158_1    1    1    0    0    0    0    1</span></span>
<span><span class="co"># 198_1    1    1    0    0    0    0    1</span></span>
<span><span class="co"># 178_1    1    1    0    0    0    0    1</span></span>
<span><span class="co"># 227_1    1    0    1    0    0    1    0</span></span>
<span><span class="co"># 202_1    1    0    1    0    0    1    0</span></span>
<span><span class="co"># 157_1    1    1    0    0    0    0    1</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $workers</span></span>
<span><span class="co"># NULL</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $drones</span></span>
<span><span class="co"># NULL</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $virginQueens</span></span>
<span><span class="co"># NULL</span></span>
<span><span class="fu"><a href="../reference/getCsdAlleles.html">getCsdAlleles</a></span><span class="op">(</span><span class="va">inbredColony</span>, unique <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># $queen</span></span>
<span><span class="co">#       3_86 3_87 3_88 3_89 3_90 3_91 3_92</span></span>
<span><span class="co"># 235_1    1    0    1    0    0    1    0</span></span>
<span><span class="co"># 235_2    0    1    0    1    0    1    1</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $fathers</span></span>
<span><span class="co">#       3_86 3_87 3_88 3_89 3_90 3_91 3_92</span></span>
<span><span class="co"># 167_1    1    1    0    0    0    0    1</span></span>
<span><span class="co"># 150_1    1    0    1    0    0    1    0</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $workers</span></span>
<span><span class="co"># NULL</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $drones</span></span>
<span><span class="co"># NULL</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $virginQueens</span></span>
<span><span class="co"># NULL</span></span></code></pre></div>
<p>Can you spot any matches? Let’s calculate the expected proportion of
homozygous brood from this mating.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calcQueensPHomBrood.html">pHomBrood</a></span><span class="op">(</span><span class="va">inbredColony</span><span class="op">)</span></span>
<span><span class="co"># [1] 0.2333333</span></span></code></pre></div>
<p>Let’s see how many homozygotes will we observe. Note that inheritance
is a random process, so a realised number of homozygotes will deviate
from the expected proportion.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inbredColony</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addWorkers.html">addWorkers</a></span><span class="op">(</span><span class="va">inbredColony</span>, nInd <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">inbredColony</span></span>
<span><span class="co"># An object of class "Colony" </span></span>
<span><span class="co"># Id: 2 </span></span>
<span><span class="co"># Location: </span></span>
<span><span class="co"># Queen: 235 </span></span>
<span><span class="co"># Number of fathers: 15 </span></span>
<span><span class="co"># Number of workers: 79 </span></span>
<span><span class="co"># Number of drones: 0 </span></span>
<span><span class="co"># Number of virgin queens: 0 </span></span>
<span><span class="co"># Has split: FALSE </span></span>
<span><span class="co"># Has swarmed: FALSE </span></span>
<span><span class="co"># Has superseded: FALSE </span></span>
<span><span class="co"># Has collapsed: FALSE </span></span>
<span><span class="co"># Is productive: FALSE</span></span>
<span><span class="fu"><a href="../reference/calcQueensPHomBrood.html">nHomBrood</a></span><span class="op">(</span><span class="va">inbredColony</span><span class="op">)</span></span>
<span><span class="co"># [1] 21</span></span></code></pre></div>
<p>We tried adding 100 workers, but we only got 79. The difference of 21
is due to csd homozygous brood. Let’s add another set of workers to show
variation in realised numbers and accumulation of information.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inbredColony</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addWorkers.html">addWorkers</a></span><span class="op">(</span><span class="va">inbredColony</span>, nInd <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">inbredColony</span></span>
<span><span class="co"># An object of class "Colony" </span></span>
<span><span class="co"># Id: 2 </span></span>
<span><span class="co"># Location: </span></span>
<span><span class="co"># Queen: 235 </span></span>
<span><span class="co"># Number of fathers: 15 </span></span>
<span><span class="co"># Number of workers: 159 </span></span>
<span><span class="co"># Number of drones: 0 </span></span>
<span><span class="co"># Number of virgin queens: 0 </span></span>
<span><span class="co"># Has split: FALSE </span></span>
<span><span class="co"># Has swarmed: FALSE </span></span>
<span><span class="co"># Has superseded: FALSE </span></span>
<span><span class="co"># Has collapsed: FALSE </span></span>
<span><span class="co"># Is productive: FALSE</span></span>
<span><span class="fu"><a href="../reference/calcQueensPHomBrood.html">nHomBrood</a></span><span class="op">(</span><span class="va">inbredColony</span><span class="op">)</span></span>
<span><span class="co"># [1] 41</span></span></code></pre></div>
<p>In total we tried adding 200 workers. We got 159 workers and 41
homozygous brood. To see all this information, we can inspect the
miscellaneous slot of the queen that contains the fathers population as
well as the cumulative number of workers, drones, homozygous brood, and
the expected proportion of homozygous brood.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/AlphaSimR/man/getMisc.html" class="external-link">getMisc</a></span><span class="op">(</span><span class="fu"><a href="../reference/getCastePop.html">getQueen</a></span><span class="op">(</span><span class="va">inbredColony</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># [[1]]</span></span>
<span><span class="co"># [[1]]$fathers</span></span>
<span><span class="co"># An object of class "Pop" </span></span>
<span><span class="co"># Ploidy: 2 </span></span>
<span><span class="co"># Individuals: 15 </span></span>
<span><span class="co"># Chromosomes: 3 </span></span>
<span><span class="co"># Loci: 300 </span></span>
<span><span class="co"># Traits: 0 </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># [[1]]$nWorkers</span></span>
<span><span class="co"># [1] 159</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># [[1]]$nDrones</span></span>
<span><span class="co"># [1] 0</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># [[1]]$nHomBrood</span></span>
<span><span class="co"># [1] 41</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># [[1]]$pHomBrood</span></span>
<span><span class="co"># [1] 0.2333333</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="inheritance-system">Inheritance system<a class="anchor" aria-label="anchor" href="#inheritance-system"></a>
</h2>
<p>TODO: add genome image (tree and inheritance and csd)? TODO: mention
recombination - why (I can’t recall anymore)?</p>
<p>Honeybees have the haplo-diploid inheritance system where queens and
workers are diploid and drones are haploid. In SIMplyBee, we simulate
drones as doubled-haploids, that is, as fully homozygous diploid
individuals. This means that they have two identical sets of
chromosomes. When they produce sperm, their gametes all have the same
one set of chromosomes. Despite them being diploid, we generally return
a haploid set of chromosomes, unless specifically requested.</p>
<p>To show all this, let’s get haplotypes and genotypes across the
segregating sites for the different castes. The haplotypes are below
shown in rows, spanning sites in columns (limiting to the first ten
sites). Genotypes are simply a sum of the two haplotypes. First the
queen:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getCasteSegSiteHaplo.html">getQueenSegSiteHaplo</a></span><span class="op">(</span><span class="va">inbredColony</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#       1_1 1_2 1_3 1_4 1_5 1_6 1_7 1_8 1_9 1_10</span></span>
<span><span class="co"># 235_1   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 235_2   0   1   1   1   0   1   1   1   0    1</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getCasteSegSiteGeno.html">getQueenSegSiteGeno</a></span><span class="op">(</span><span class="va">inbredColony</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#  1_1  1_2  1_3  1_4  1_5  1_6  1_7  1_8  1_9 1_10 </span></span>
<span><span class="co">#    1    1    1    1    1    1    2    1    0    1</span></span></code></pre></div>
<p>now all fathers:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getCasteSegSiteHaplo.html">getFathersSegSiteHaplo</a></span><span class="op">(</span><span class="va">inbredColony</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#       1_1 1_2 1_3 1_4 1_5 1_6 1_7 1_8 1_9 1_10</span></span>
<span><span class="co"># 167_1   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 150_1   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 142_1   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 153_1   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 220_1   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 191_1   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 199_1   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 156_1   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 146_1   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 158_1   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 198_1   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 178_1   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 227_1   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 202_1   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 157_1   1   0   0   0   1   0   1   0   0    0</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getCasteSegSiteGeno.html">getFathersSegSiteGeno</a></span><span class="op">(</span><span class="va">inbredColony</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#     1_1 1_2 1_3 1_4 1_5 1_6 1_7 1_8 1_9 1_10</span></span>
<span><span class="co"># 167   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 150   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 142   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 153   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 220   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 191   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 199   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 156   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 146   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 158   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 198   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 178   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 227   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 202   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 157   1   0   0   0   1   0   1   0   0    0</span></span></code></pre></div>
<p>each father is listed once (one row per father), but we can retrieve
the diploid state, if this is desired (showing just one father to show
this clearly):</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getCasteSegSiteHaplo.html">getFathersSegSiteHaplo</a></span><span class="op">(</span><span class="va">inbredColony</span>, nInd <span class="op">=</span> <span class="fl">1</span>, dronesHaploid <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#       1_1 1_2 1_3 1_4 1_5 1_6 1_7 1_8 1_9 1_10</span></span>
<span><span class="co"># 167_1   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 167_2   1   0   1   1   1   0   1   1   1    1</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getCasteSegSiteGeno.html">getFathersSegSiteGeno</a></span><span class="op">(</span><span class="va">inbredColony</span>, nInd <span class="op">=</span> <span class="fl">1</span>, dronesHaploid <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span><span class="co">#     1_1 1_2 1_3 1_4 1_5 1_6 1_7 1_8 1_9 1_10</span></span>
<span><span class="co"># 167   2   0   2   2   2   0   2   2   2    2</span></span></code></pre></div>
<p>now two workers:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getCasteSegSiteHaplo.html">getWorkersSegSiteHaplo</a></span><span class="op">(</span><span class="va">inbredColony</span>, nInd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#       1_1 1_2 1_3 1_4 1_5 1_6 1_7 1_8 1_9 1_10</span></span>
<span><span class="co"># 236_1   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 236_2   1   0   1   1   1   0   1   1   1    1</span></span>
<span><span class="co"># 237_1   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 237_2   1   0   0   0   1   0   1   0   0    0</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getCasteSegSiteGeno.html">getWorkersSegSiteGeno</a></span><span class="op">(</span><span class="va">inbredColony</span>, nInd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#     1_1 1_2 1_3 1_4 1_5 1_6 1_7 1_8 1_9 1_10</span></span>
<span><span class="co"># 236   2   0   1   1   2   0   2   1   1    1</span></span>
<span><span class="co"># 237   2   0   0   0   2   0   2   0   0    0</span></span></code></pre></div>
<p>and finally four drones:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inbredColony</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addDrones.html">addDrones</a></span><span class="op">(</span><span class="va">inbredColony</span>, nInd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/getCasteSegSiteHaplo.html">getDronesSegSiteHaplo</a></span><span class="op">(</span><span class="va">inbredColony</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#       1_1 1_2 1_3 1_4 1_5 1_6 1_7 1_8 1_9 1_10</span></span>
<span><span class="co"># 436_1   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 437_1   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 438_1   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 439_1   1   0   0   0   1   0   1   0   0    0</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getCasteSegSiteGeno.html">getDronesSegSiteGeno</a></span><span class="op">(</span><span class="va">inbredColony</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#     1_1 1_2 1_3 1_4 1_5 1_6 1_7 1_8 1_9 1_10</span></span>
<span><span class="co"># 436   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 437   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 438   1   0   0   0   1   0   1   0   0    0</span></span>
<span><span class="co"># 439   1   0   0   0   1   0   1   0   0    0</span></span></code></pre></div>
<p>SIMplyBee has the same genome retrieval functions as AlphaSimR, for
all segregating sites (<code>segSite</code>), quantitative trait loci
(<code>qtl</code>), identity by descent (<code>ibd</code>), and marker
array/chip (<code>chip</code>). Here, site, locus and marker are all
synonyms for a position in the genome. Study the index of available
<code>get*()</code> functions in SIMplyBee and read the genomics
vignette for more information.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">SIMplyBee</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jana Obšteter, Laura Strachan, Jernej Bubnič, Gregor Gorjanc.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
